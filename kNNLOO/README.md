# Скользащий контроль

Для проверки оптимальности k используется Критерий Скользящего Контроля **LOO** (Leave One Out). Данный критерий проверяет оптимальность значения **k** следующим образом:

---

1. Из обучающей выборки удаляется **i-й** объект.
2. Запоминаем старый класс **i-го** объекта.
3. Запускаем алгоритм для оставшейся выборки. В результате работы **i-му** элементу присваивается новый класс на основе имеющейся выборки. Если значения нового и старого класса совпали, то **i-ый** элемент классифицировало верно. При их же несовпадении сумма ошибки увеличивается на 1.
4. Шаги 1-3 повторяются для каждого объекта выборки при фиксированном **k**. 

Код:

```R
LOO = function(xl, sort = sortObjectsByDist, classification = classif_kNN){
  n = dim(xl)[1];
  DataA = array(0,n);
  
  for(i in 1:n){
    orderedXl = sort(xl[-i,], c(xl[i,1], xl[i,2]));
    
    for(k in 1:n){
      class = classification(orderedXl, k);
      #print(class);
      #print(xl[i,3]);
      if(class != c(xl[i,3])){
        DataA[k] = DataA[k] + 1;
      }
    }
    print(i);
    print(DataA);
  }
  return (DataA)
}
```
График зависимости LOO(k):

![Ну нет ее и все! Отстань!](/kNNLOO/kNNLOO.png)
